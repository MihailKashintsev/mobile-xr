name: Release

on:
  push:
    tags: ['v*.*.*']

jobs:
  release:
    runs-on: ubuntu-latest
    permissions:
      contents: write
    steps:
      - uses: actions/checkout@v4
        with: { fetch-depth: 0 }

      - uses: actions/setup-node@v4
        with: { node-version: 20, cache: npm }

      - name: Build
        run: npm ci && npm run build
        env:
          APP_VERSION: ${{ github.ref_name }}

      - name: Zip dist
        run: |
          cd dist
          zip -r ../mobile-xr-${{ github.ref_name }}.zip .
          cd ..
          echo "üì¶ –ê—Ä—Ö–∏–≤: $(du -sh mobile-xr-${{ github.ref_name }}.zip | cut -f1)"

      - name: Create Release
        uses: softprops/action-gh-release@v2
        with:
          files: mobile-xr-${{ github.ref_name }}.zip
          generate_release_notes: true
          body: |
            ## Mobile XR ${{ github.ref_name }}

            ### üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ / –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ
            –û—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ ‚Äî –æ–±–Ω–æ–≤–∏—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
            **https://MihailKashintsev.github.io/mobile-xr**

            –ò–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∫–∞–∫ PWA (–∫–Ω–æ–ø–∫–∞ ¬´–î–æ–±–∞–≤–∏—Ç—å –Ω–∞ —ç–∫—Ä–∞–Ω¬ª).

            ### üìã –ò–∑–º–µ–Ω–µ–Ω–∏—è
            *–°–º–æ—Ç—Ä–∏ —Å–ø–∏—Å–æ–∫ –∫–æ–º–º–∏—Ç–æ–≤ –Ω–∏–∂–µ*
